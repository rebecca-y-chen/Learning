<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8" />
<title>拼貼我的畢卡索自畫像</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<style>
  body {
    margin: 0;
    height: 100vh;
    display: flex;
    font-family: "Chiron GoRound TC", sans-serif;
    background: #202a5e;
    color: #fff;
  }

  /* 左側素材欄 */
  .palette {
    width: 280px;
    background: #111827;
    overflow-y: auto;
    padding: 16px;
    border-right: 3px solid #374151;
  }
  .palette h2 {
    font-size: 18px;
    margin: 0 0 12px;
    color: #facc15;
  }
  .item {
    display: inline-block;
    margin: 6px;
    padding: 8px;
    border-radius: 12px;
    background: #1f2937;
    cursor: grab;
  }
  .item img {
    width: 70px;
    height: auto;
    display: block;
  }

  /* 右側相框 */
  .frame {
    flex: 1;
    display: flex;
    align-items: center;
    justify-content: center;
    position: relative;
    background: #f8f8f8;
  }
  .frame-bg {
    width: 90%;
    max-width: 600px;
    height: auto;
    border: 8px solid #d9c9a5;
    border-radius: 12px;
    box-shadow: 0 8px 20px rgba(0,0,0,0.4);
    pointer-events: none;
  }
  .hint {
    position: absolute;
    top: 10px;
    font-size: 1rem;
    color: #6b7280;
  }

  /* 放進相框的素材 */
  .placed {
    position: absolute;
    width: 100px;
    cursor: move;
    user-select: none;
  }
</style>
</head>
<body>

  <!-- 左：素材欄 -->
  <div class="palette" id="palette">
    <h2>素材工具箱</h2>
  </div>

  <!-- 右：相框 -->
  <div class="frame" id="frame">
    <p class="hint">把五官拖進來吧！</p>
    <img src="images/picasso/Portrait.png" class="frame-bg" alt="背景相框">
  </div>

<script>
const frame = document.getElementById('frame');
const palette = document.getElementById('palette');

// 假設每種素材有多個版本
const categories = {
    eye: 8,
    eyebrow: 8,
    face: 5,
    hair: 6,
    nose: 5,
    mouth: 5,
    ear: 5
};

// 生成左邊素材
for (const [part, count] of Object.entries(categories)) {
  for (let i = 1; i <= count; i++) {
    const div = document.createElement('div');
    div.className = 'item';
    div.draggable = true;
    div.dataset.src = `images/picasso/${part}${i}.png`;
    div.innerHTML = `<img src="${div.dataset.src}" alt="${part}${i}">`;
    palette.appendChild(div);
  }
}

// palette 拖曳開始
document.querySelectorAll('.item').forEach(item => {
  item.addEventListener('dragstart', e => {
    e.dataTransfer.setData('src', item.dataset.src);
  });
});

// 相框允許放置
frame.addEventListener('dragover', e => e.preventDefault());

// 拖曳放到相框
frame.addEventListener('drop', e => {
  e.preventDefault();
  const src = e.dataTransfer.getData('src');
  if (!src) return;

  const img = document.createElement('img');
  img.src = src;
  img.className = 'placed';

  const rect = frame.getBoundingClientRect();
  img.style.left = (e.clientX - rect.left - 50) + 'px';
  img.style.top = (e.clientY - rect.top - 50) + 'px';

  frame.appendChild(img);
  makeDraggable(img);
});

// 讓放置後的圖能拖曳
function makeDraggable(el) {
  let offsetX, offsetY;
  el.addEventListener('mousedown', e => {
    offsetX = e.offsetX;
    offsetY = e.offsetY;

    function moveHandler(ev) {
      const rect = frame.getBoundingClientRect();
      el.style.left = (ev.clientX - rect.left - offsetX) + 'px';
      el.style.top  = (ev.clientY - rect.top - offsetY) + 'px';
    }
    function upHandler() {
      document.removeEventListener('mousemove', moveHandler);
      document.removeEventListener('mouseup', upHandler);
    }

    document.addEventListener('mousemove', moveHandler);
    document.addEventListener('mouseup', upHandler);
  });
}
</script>
</body>
</html>